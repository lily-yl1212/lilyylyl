<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>舆情分析平台</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
        }

      .navbar {
            background-color: #007BFF;
            color: white;
        }

      .navbar-brand {
            font-size: 24px;
        }

      .nav-link {
            color: white;
        }

      .section-title {
            margin-top: 30px;
            margin-bottom: 20px;
            text-align: center;
        }

      .btn-custom {
            background-color: #007BFF;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            border-radius: 5px;
            border: none;
        }

      .btn-custom:hover {
            background-color: #0056b3;
        }

      .input-group {
            margin-bottom: 20px;
        }

      .result-area {
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            background-color: white;
            margin-top: 20px;
        }

      .chart-area {
            margin-top: 30px;
        }
    </style>
</head>

<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <a class="navbar-brand" href="#">舆情分析平台</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="#crawl-data">爬取数据</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#process-text">处理文本</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#generate-word-cloud">生成词云图</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#generate-emotion-chart">生成情绪占比图</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- 爬取数据模块 -->
    <section id="crawl-data">
        <h2 class="section-title">爬取数据</h2>
        <div class="container text-center">
            <a href="https://www.bazhuayu.com/" class="btn-custom">跳转到八爪鱼</a>
            <a href="https://www.houyicraw.com/" class="btn-custom">跳转到后羿采集器</a>
            <p class="mt-3">使用爬虫软件前，请确保已安装并配置好相应环境。根据需求设置爬虫任务，爬取相关舆情数据。</p>
        </div>
    </section>

    <!-- 处理文本模块 -->
    <section id="process-text">
        <h2 class="section-title">处理文本</h2>
        <div class="container">
            <div class="input-group">
                <textarea class="form-control" id="input-text" placeholder="请输入或粘贴需要处理的文本"
                    style="height: 200px"></textarea>
            </div>
            <button class="btn btn-primary" id="process-button">处理文本</button>
            <div class="result-area" id="process-result"></div>
        </div>
    </section>

    <!-- 生成关键词词云图模块 -->
    <section id="generate-word-cloud">
        <h2 class="section-title">生成关键词词云图</h2>
        <div class="container">
            <div class="chart-area">
                <canvas id="word-cloud-chart"></canvas>
            </div>
            <button class="btn btn-primary" id="generate-word-cloud-button">生成词云图</button>
        </div>
    </section>

    <!-- 生成情绪占比图模块 -->
    <section id="generate-emotion-chart">
        <h2 class="section-title">生成情绪占比图</h2>
        <div class="container">
            <div class="chart-area">
                <canvas id="emotion-chart"></canvas>
            </div>
            <button class="btn btn-primary" id="generate-emotion-chart-button">生成情绪占比图</button>
        </div>
    </section>

    <!-- 页脚 -->
    <footer class="bg-dark text-white text-center py-3">
        &copy; 2025 舆情分析平台版权所有
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.1/dist/echarts.min.js"></script>
    <script>
        // 引入jieba.js库文件路径，假设放在当前目录下
        const jieba = require('./jieba.min.js');

        // 模拟情感分析函数，这里是简单示例，实际需更复杂算法
        function sentimentAnalysis(words) {
            let positiveCount = 0;
            let negativeCount = 0;
            let neutralCount = 0;
            const positiveWords = ['好', '支持', '喜欢'];
            const negativeWords = ['坏', '反对', '讨厌'];
            words.forEach(word => {
                if (positiveWords.includes(word)) {
                    positiveCount++;
                } else if (negativeWords.includes(word)) {
                    negativeCount++;
                } else {
                    neutralCount++;
                }
            });
            return [positiveCount, negativeCount, neutralCount];
        }

        let processedWords = [];

        $('#process-button').click(function () {
            const inputText = $('#input-text').val();
            // 使用jieba进行分词
            processedWords = jieba.cut(inputText, true);
            // 简单的筛选，去除长度小于2的词
            processedWords = processedWords.filter(word => word.length >= 2);
            $('#process-result').html('<p>处理后的文本：</p><p>' + processedWords.join(', ') + '</p>');
        });

        $('#generate-word-cloud-button').click(function () {
            if (processedWords.length === 0) {
                alert('请先处理文本');
                return;
            }
            const wordCountMap = {};
            processedWords.forEach(word => {
                if (!wordCountMap[word]) {
                    wordCountMap[word] = 1;
                } else {
                    wordCountMap[word]++;
                }
            });
            const wordCloudData = [];
            for (const word in wordCountMap) {
                wordCloudData.push({ name: word, value: wordCountMap[word] });
            }
            const wordCloudChart = echarts.init(document.getElementById('word-cloud-chart'));
            const option = {
                series: [
                    {
                        type: 'wordCloud',
                        shape: 'circle',
                        data: wordCloudData
                    }
                ]
            };
            wordCloudChart.setOption(option);
        });

        $('#generate-emotion-chart-button').click(function () {
            if (processedWords.length === 0) {
                alert('请先处理文本');
                return;
            }
            const emotionCounts = sentimentAnalysis(processedWords);
            const emotionChart = echarts.init(document.getElementById('emotion-chart'));
            const option = {
                series: [
                    {
                        type: 'pie',
                        data: [
                            { value: emotionCounts[0], name: '正面' },
                            { value: emotionCounts[1], name: '负面' },
                            { value: emotionCounts[2], name: '中性' }
                        ]
                    }
                ]
            };
            emotionChart.setOption(option);
        });
    </script>
</body>

</html>
